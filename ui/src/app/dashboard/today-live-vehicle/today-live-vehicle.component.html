<mat-expansion-panel class="full-width margin-bottom-20m mb-10" fxLayoutGap="10px" [expanded]="true">
    <mat-expansion-panel-header class="full-width">
      <mat-panel-title>
        <span>{{ translationData.lblTodaysLiveVehicle
          || 'Todays Live Vehicles' }}</span>
       
      </mat-panel-title>
    </mat-expansion-panel-header>
    <button class='reportButton' mat-flat-button color="primary" (click)="navigateToReport()">
        {{ translationData.lblShowReport || 'Show Report'}}
    </button>
    <!-- block data -->
    <mat-error *ngIf="dataError">
      {{ translationData.lblTodaysLiveVehicleError || errorMessage }}
  </mat-error>
    <div style='margin-bottom: 10px;' *ngIf='liveVehicleData && !dataError'>
        <div fxLayout="row" fxLayoutAlign="space-between" class="full-width" fxLayoutGap="10px">
          <div [hidden]="!checkForPreference('distance')" class="areaWidth  divTile normalClass" fxLayout="column" fxLayoutAlign="left">
            <span>
              <div>{{ translationData.lblDistance || 'Distance' }} </div>
              <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;'>{{distance}} {{prefUnitFormat == 'dunit_Metric' ?  (this.translationData.lblkms || 'Km') : (this.translationData.lblmile || 'Miles')}} </div>
            </span>
          </div>
          <div [hidden]="!checkForPreference('drivingtime')" class="areaWidth  divTile normalClass" fxLayout="column" fxLayoutAlign="left">
            <span>
              <div>{{ translationData.lblDrivingTime || 'Driving Time' }} </div>
              <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;'>{{drivingTime}}</div>
            </span>
          </div>
            <div [hidden]="!checkForPreference('drivers')" class="areaWidth  divTile normalClass" fxLayout="column" fxLayoutAlign="left">
              <span>
                <div>{{ translationData.lblDrivers || 'Drivers' }} </div>
                <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;'>{{liveVehicleData.driverCount}}</div>
              </span>
            </div>
            <div [hidden]="!checkForPreference('criticalalerts')" class="areaWidth  divTile activeClass" fxLayout="column" fxLayoutAlign="left">
              <span>
                <div>{{ translationData.lblCriticalAlerts || 'Critical Alerts' }}: </div>
                <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;'>{{liveVehicleData.criticleAlertCount}}</div>
              </span>
            </div>
        </div>
    </div>
    <!-- Charts  -->
    <div style='margin-bottom: 10px;'  *ngIf='liveVehicleData'>
        <div fxLayout="row" fxLayoutAlign="space-between" class="full-width" fxLayoutGap="10px">
          <div [hidden]="!checkForPreference('activevehicles')" class="chartTile col-md-4"  [ngClass]="{'warningClass':(activeThreshold==0)}">
            <div class="textDiv">
              <div>{{ translationData.lblActiveVehicles || 'Active Vehicles' }}</div>
              <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif; text-align: center;'>{{liveVehicleData.todayActiveVinCount}}</div>
            </div>
            
            <div class="col-md-8 chart-wrapper chartDimension" *ngIf='!(activeThreshold==0)'>
                <canvas #chart1 baseChart
                  [data]="doughnutChartActiveVehicleData"
                  [labels]="doughnutChartLabels"
                  [chartType]="doughnutChartType"
                  [options]="doughnutChartOptions"
                  [colors]="doughnutColors"
                  [plugins]="doughnutChartPlugins">
                </canvas>
              </div>
              <div class="col-md-8 chart-wrapper chartDimension warningTextDiv" *ngIf='(activeThreshold==0)'>
                <i class="fa fa-exclamation-circle mr-1 warningIcon"></i> {{translationData.lblThresholdError || 'Chart not applicable for zero threshold value'}}
              </div>
          </div>
          <div [hidden]="!checkForPreference('timebasedutilizationrate')" class="chartTile col-md-4"  [ngClass]="{'warningClass':(timeBasedThreshold==0)}">
            <div class="textDiv">
              <div>{{ translationData.lblTimeBased || 'Time Based Utilisation Rate' }} </div>
              <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;text-align: center;'>{{timeBasedRate}}</div>
            </div>
            
            <div class="col-md-8 chart-wrapper chartDimension" *ngIf='!(timeBasedThreshold==0)'>
                <canvas #chart2 baseChart
                  [data]="doughnutChartTimeBasedData"
                  [labels]="doughnutChartTimeBasedLabels"
                  [chartType]="doughnutChartType"
                  [options]="doughnutChartTimeOptions"
                  [colors]="doughnutTimeColors"
                  [plugins]="doughnutChartTimePlugins">
                </canvas>
              </div>
              <div class="col-md-8 chart-wrapper chartDimension warningTextDiv" *ngIf='(timeBasedThreshold==0)'>
                <i class="fa fa-exclamation-circle mr-1 warningIcon"></i> {{translationData.lblThresholdError || 'Chart not applicable for zero threshold value'}}
              </div>
          </div>
          <div [hidden]="!checkForPreference('distancebasedutilizationrate')" class="chartTile col-md-4" [ngClass]="{'warningClass':(distanceBasedThreshold==0)}">
            <div class="textDiv">
                <div>{{ translationData.lblDistanceBased || 'Distance Based Utilisation Rate' }} </div>
                <div style='font: 500 14px/32px Roboto, "Helvetica Neue", sans-serif;text-align: center;'>{{distanceRate}}{{prefUnitFormat == 'dunit_Metric' ?  (this.translationData.lblkms || 'Km') : (this.translationData.lblmile || 'Miles')}} </div>
            </div>
              
            <div class="col-md-8 chart-wrapper chartDimension" *ngIf='!(distanceBasedThreshold==0)'>
                <canvas #chart3 baseChart
                  [data]="doughnutChartDistanceBasedData"
                  [labels]="doughnutChartDistanceBasedLabels"
                  [chartType]="doughnutChartType"
                  [options]="doughnutChartDistanceOptions"
                  [colors]="doughnutDistanceColors"
                  [plugins]="doughnutChartDistancePlugins">
                </canvas>
              </div>
              <div class="col-md-8 chart-wrapper chartDimension warningTextDiv" *ngIf='(distanceBasedThreshold==0)'>
                <i class="fa fa-exclamation-circle mr-1 warningIcon"></i> {{translationData.lblThresholdError || 'Chart not applicable for zero threshold value'}}
              </div>
            </div>
        </div>
    </div> 
  </mat-expansion-panel>
