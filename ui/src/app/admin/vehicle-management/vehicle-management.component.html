<div *ngIf='grpTitleVisible' fxLayout="row" fxLayoutAlign="center center"
style='padding:10px; color:#fff; background: #5dc24e;'>
<div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="center center" style='width:95%;'>
  {{ userCreatedMsg }}
</div>
<div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="center center">
  <mat-icon (click)='onClose()' style='cursor: pointer;'>close</mat-icon>
</div>
</div>

<div class='bgtrans'>
  <div *ngIf='!editFlag && !viewFlag'>
    <mat-card class='mat-elevation-z'>
      <div fxLayout="row" fxLayoutAlign="space-between" class='margin-bottom-sm'>
        <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
          <span style='font: 500 16px/32px Roboto, "Helvetica Neue", sans-serif;'>{{
            translationData.lblAllVehicleGroupVehicleDetails || 'All Vehicle Group/Vehicle Details' }}</span>
        </div>
      </div>
      <div fxLayout="row" fxLayoutGap="50px" fxLayoutAlign="space-between" class='margin-bottom-sm'>
        <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="end">
          <mat-form-field appearance="outline">
              <input matInput (keyup)="applyFilter($event.target.value)" placeholder="{{ translationData.lblSearch || 'Search' }}">
              <span matPrefix><mat-icon>search</mat-icon></span>
          </mat-form-field>
        </div>
        <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="center">
          <!-- <span>{{ translationData.lblViewby || 'View by' }}:</span> -->
          <mat-radio-group (change)='onChange($event)'>
            <mat-radio-button style='margin-right: 20px;' value="group"
              [checked]="selectedType ===  'group' ? true : false">{{ translationData.lblGroup || 'Group' }}
            </mat-radio-button>
            <mat-radio-button style='margin-right: 20px;' value="vehicle"
              [checked]="selectedType ===  'vehicle' ? true : false">{{ translationData.lblVehicle || 'Vehicle' }}
            </mat-radio-button>
            <mat-radio-button value="both" [checked]="selectedType ===  'both' ? true : false">{{
              translationData.lblBoth || 'Both' }}</mat-radio-button>
          </mat-radio-group>
        </div>
        <div *ngIf="!adminAccessType.adminReadOnlyAccess" fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="end">
          <button mat-flat-button color="primary" (click)="newVehicleGroup()">
            <mat-icon>add_circle_outline</mat-icon> {{ translationData.lblNewVehicleGroup || 'New Vehicle Group' }}
          </button>
        </div>
      </div>
      <div fxLayout="row" class='margin-top-xlg'>
        <div fxLayout="column" class='full-width'>
          <mat-table [dataSource]="dataSource" class="table-items" matSort>
            <ng-container *ngFor="let disCol of cols; let colIndex = index" matColumnDef="{{disCol}}">
              <div
                *ngIf="disCol != 'action' && disCol!='status' && columnNames[colIndex]!='Vehicle Group' && columnNames[colIndex]!='Vehicle Group/Vehicle' && disCol!='isVehicleGroup' ">
                <mat-header-cell *matHeaderCellDef mat-sort-header>{{columnNames[colIndex]}}</mat-header-cell>
                <mat-cell [ngClass]="{'tablemargin': element[disCol]==null }" *matCellDef="let element ">
                  {{element[disCol]==null?'-':element[disCol]}} </mat-cell>
              </div>
              <div *ngIf="columnNames[colIndex]=='Vehicle Group' ">
                <mat-header-cell *matHeaderCellDef mat-sort-header matSortDirection="asc">{{columnNames[colIndex]}}</mat-header-cell>
                <mat-cell *matCellDef="let element " matTooltip={{element[disCol]}}> 
                  <span *ngIf="element.newTag" class='newTagIcon marginLeft-24'></span>
            <span *ngIf="element.newTag" class='newTxtCss'>{{ translationData.lblNew || 'New' }}</span>
            <span [ngClass]="{ 'marginLeft-14': element.newTag }">
                  {{element[disCol]}}</span>
                  <div *ngIf="element.isVehicleGroup==true">
                    <img src='assets/images/group_icon.svg' style="width: 40px; height: 40px;" />
                    <span class='iconTxt'>{{ (element.vehicleCount < 10) ? '0' : '' }}{{ element.vehicleCount }}</span>
                  </div>
                </mat-cell>
              </div>
              <div *ngIf="columnNames[colIndex]=='Vehicle Group/Vehicle' ">
                <mat-header-cell *matHeaderCellDef mat-sort-header>{{columnNames[colIndex]}}</mat-header-cell>
                <mat-cell *matCellDef="let element " matTooltip={{element[disCol]}}> {{element[disCol]}}
                  <div *ngIf="element.isVehicleGroup==true">
                    <img src='assets/images/group_icon.svg' style="width: 40px; height: 40px;" />
                    <span class='iconTxt'>{{ (element.vehicleCount < 10) ? '0' : '' }}{{ element.vehicleCount }}</span>
                  </div>
                </mat-cell>
              </div>
              <div *ngIf="columnNames[colIndex]=='Status'  ">
                <mat-header-cell *matHeaderCellDef style="width: 20px;">Status</mat-header-cell>
                <mat-cell *matCellDef="let element ">
                  <div *ngIf="element[disCol]==73 ">
                    <img src='assets/images/Opt_in.svg' style="width: 20px;height: 20px;" />
                  </div>
                  <div *ngIf="element[disCol]==79 ">
                    <img src='assets/images/Ota.svg' style="width: 20px;height: 20px;" />
                  </div>
                  <div *ngIf="element[disCol]==84 ">
                    <img src='assets/images/terminated.svg' style="width: 20px;height: 20px;" />
                  </div>
                  <div *ngIf="element[disCol]==85 ">
                    <img src='assets/images/Opt_out.svg' style="width: 20px;height: 20px;" />
                  </div>
                </mat-cell>
              </div>
              <div *ngIf="disCol=='isVehicleGroup'">
                <mat-header-cell *matHeaderCellDef [style.display]="'none'">{{columnNames[colIndex]}}</mat-header-cell>
                <mat-cell *matCellDef="let row" [style.display]="'none'">
                  {{row.isVehicleGroup}}
                </mat-cell>
              </div>
              <div *ngIf="disCol == 'action'">
                <mat-header-cell *matHeaderCellDef>{{columnNames[colIndex]}}</mat-header-cell>
                <mat-cell *matCellDef="let row">
                  <button class='actionBtn' mat-flat-button (click)="viewFunc(row)" matTooltip="View">
                    <mat-icon>visibility</mat-icon>
                  </button>
                  <button *ngIf="!adminAccessType.adminReadOnlyAccess" class='actionBtn' mat-flat-button (click)="editFunc(row)" matTooltip="Edit">
                    <mat-icon>create</mat-icon>
                  </button>
                  <button *ngIf="(selectedType!='vehicle' && row.isVehicleGroup==true) && (adminAccessType.adminFullAccess)" class='actionBtn' mat-flat-button
                    (click)="deleteFunc(row)" matTooltip="Delete">
                    <mat-icon class="deleteIcon">delete_outline</mat-icon>
                  </button>
                </mat-cell>
              </div>
            </ng-container>
            <mat-header-row *matHeaderRowDef="cols"></mat-header-row>
            <mat-row *matRowDef="let row; columns: cols;"></mat-row>
          </mat-table>
          <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
        </div>
        <app-spinner *ngIf="showLoadingIndicator" ></app-spinner>
      </div>
    </mat-card>
  </div>
  <div *ngIf='editFlag'>
    <app-create-edit-vehicle-details [translationData]='translationData' [createStatus]='createStatus'
      [title]='titleText' [gridData]='rowsData' [groupInfo]='groupInfo' [viewGroupMode]='viewGroupMode'
      (backToPage)='editData($event)'>
    </app-create-edit-vehicle-details>
  </div>
  <div *ngIf='viewFlag'>
    <app-edit-vin-setting [translationData]='translationData' [vinData]='vinData' [viewMode]='viewMode'
      (backToPage)='onBackToPage($event)'>
    </app-edit-vin-setting>
  </div>
</div>