<div  *ngIf = "!importPOIClicked">
<div class='bgtrans'>
  <div *ngIf='titleVisible' fxLayout="row" fxLayoutAlign="center center"
    style='padding:10px; color:#fff; background: #5dc24e;'>
    <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="center center" style='width:95%;'>
      {{ poiCreatedMsg }}
    </div>
    <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="center center">
      <mat-icon (click)='onClose()' style='cursor: pointer;'>close</mat-icon>
    </div>
  </div>
</div>
<div>
<!-- <app-common-map *ngIf="mapFlag"></app-common-map> -->
<div *ngIf='!createEditViewGeofenceFlag'>
<mat-card class='mat-elevation-z' *ngIf='!createEditViewPoiFlag'>
  <div fxLayout="row" fxLayoutAlign="space-between" class='margin-bottom-sm'>
    <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
      <span style='font: 500 16px/32px Roboto, "Helvetica Neue", sans-serif;'>POI ({{poiInitData.length}})</span>
    </div>
   
    <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="end">
      <div fxLayout="row" class='areaWidth'>
        <button mat-flat-button color="primary" [matMenuTriggerFor]="belowMenu">
          <mat-icon>add_circle_outline</mat-icon> New Landmark
        </button>
        <mat-menu #belowMenu="matMenu" yPosition="below">
          <button mat-menu-item (click)="createEditView()">New POI</button>
          <button mat-menu-item (click)="onGeofenceSelection()">New Geofence</button>
        </mat-menu>
      </div>
    </div>
  </div>
  <div fxLayout="row" fxLayoutAlign="space-between" class='margin-bottom-sm'>
    <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
      <mat-form-field appearance="outline">
        <input matInput (keyup)="poiApplyFilter($event.target.value)" placeholder="Search ">
        <span matPrefix>
          <mat-icon>search</mat-icon>
        </span>
      </mat-form-field>
    </div>
    <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
      <mat-form-field appearance="outline">
        <mat-select  (selectionChange)="onCategoryChange($event)" placeholder="{{ translationData.lblSelectCategory || 'Select Category' }}">
        <mat-option *ngFor="let rer of categoryList" [value]="rer.id">
            {{ rer.name }}
        </mat-option>
        </mat-select>
    </mat-form-field>
    </div>
    <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
    <mat-form-field appearance="outline">
      <mat-select (selectionChange)="onSubCategoryChange($event)" placeholder="{{ translationData.lblSelectSubCategory || 'Select Sub-Category' }}">
      <mat-option *ngFor="let rer of subCategoryList" [value]="rer.id">
          {{ rer.name }}
      </mat-option>
      </mat-select>
  </mat-form-field>
    </div>
    <!-- <div>
      <button mat-flat-button (click)="importPOIExcel()">
        {{ translationData.lblImport || 'Import' }}<mat-icon>file_download</mat-icon>
      </button>
    </div> -->
    <div fxLayout="column" fxLayoutGap="1px" fxLayoutAlign="left">
      <button mat-button [matMenuTriggerFor]="menu"><mat-icon>file_upload</mat-icon>Export<mat-icon>more_vert</mat-icon></button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="exportAsExcelFile()">Excel</button>
      </mat-menu>
    </div>
    <div class="areaWidth" fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="end">
      <button mat-flat-button color="warn">
        <mat-icon>deleteicon</mat-icon> Delete
      </button>
    </div>
  </div>
  <div *ngIf='poiInitData.length == 0'>No Record Found</div>
  <div *ngIf='poiInitData.length > 0'>
    <mat-table [dataSource]="poidataSource" class="table-items" matSort>
      <ng-container matColumnDef="All">
        <mat-header-cell *matHeaderCellDef>
          <mat-checkbox (change)='$event ? masterToggleForPOI() : null'
            [checked]='selectedpois.hasValue() && isAllSelectedForPOI()'
            [indeterminate]='selectedpois.hasValue() && !isAllSelectedForPOI()'
            [aria-label]='checkboxLabelForPOI()'>
          </mat-checkbox>
          <span style="margin: 5px 0px 0px 5px;">All</span>
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <!-- <span *ngIf="row.newTag" class='newTagIcon marginLeft-24'></span>
          <span *ngIf="row.newTag" class='newTxtCss'>{{ translationData.lblNew || 'New' }}</span>
          <span [ngClass]="{ 'marginLeft-14': row.newTag }"></span> -->
          <mat-checkbox (click)='$event.stopPropagation()' (change)='$event ? selectedpois.toggle(row) : null'
            [checked]='selectedpois.isSelected(row)' [aria-label]='checkboxLabelForPOI(row)'>
          </mat-checkbox>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="Icon">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Icon</mat-header-cell>
        <mat-cell *matCellDef="let row">
          <mat-icon>place</mat-icon>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Name</mat-header-cell>
        <mat-cell *matCellDef="let row">{{ row.name }}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="categoryName">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Category</mat-header-cell>
        <mat-cell *matCellDef="let row">{{ row.categoryName }}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="subCategoryName">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Sub-Category</mat-header-cell>
        <mat-cell *matCellDef="let row">{{ row.subCategoryName }}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="address">
        <mat-header-cell *matHeaderCellDef mat-sort-header>Address</mat-header-cell>
        <mat-cell *matCellDef="let row">{{ row.address }}, {{ row.city }}, {{ row.country }}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="Actions">
        <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <button class='actionBtn' mat-flat-button (click)="editViewPoi(row, 'view')" matTooltip='View'>
            <mat-icon>visibility</mat-icon>
          </button>
          <button *ngIf="!adminAccessType.adminReadOnlyAccess" class='actionBtn' mat-flat-button (click)="editViewPoi(row, 'edit')" matTooltip="Edit">
            <mat-icon>create</mat-icon>
          </button>
          <button *ngIf="adminAccessType.adminFullAccess" class='actionBtn' mat-flat-button (click)="deletePoi(row)" matTooltip="Delete">
            <mat-icon class="deleteIcon">delete_outline</mat-icon>
          </button>
        </mat-cell>
      </ng-container>
      <mat-header-row *matHeaderRowDef="displayedColumnsPoi"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumnsPoi;">
      </mat-row>
    </mat-table>
    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" (page)="pageSizeUpdated($event)"></mat-paginator>
  </div>
  <app-spinner *ngIf="showLoadingIndicator"></app-spinner>
</mat-card>
</div>
 <!-- for Geofence table -->

 <div *ngIf='!createEditViewGeofenceFlag'>  
 <mat-card class='mat-elevation-z' *ngIf='!createEditViewPoiFlag'>
<div fxLayout="row" fxLayoutAlign="space-between" class='margin-bottom-sm'>
  <div fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
    <span style='font: 500 16px/32px Roboto, "Helvetica Neue", sans-serif;'>Geofence ({{geoInitData.length}})</span>
  </div>
</div>
<div fxLayout="row" fxLayoutAlign="space-between" class='margin-bottom-sm'>
  <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
    <mat-form-field appearance="outline">
      <input matInput (keyup)="geoApplyFilter($event.target.value)" placeholder="Search ">
      <span matPrefix>
        <mat-icon>search</mat-icon>
      </span>
    </mat-form-field>
  </div>
  <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
    <mat-form-field appearance="outline">
      <mat-select  (selectionChange)="onCategoryChange($event)" placeholder="{{ translationData.lblSelectCategory || 'Select Category' }}">
      <mat-option *ngFor="let rer of categoryList" [value]="rer.id">
          {{ rer.name }}
      </mat-option>
      </mat-select>
  </mat-form-field>
  </div>
  <div class='areaWidth' fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="left">
  <mat-form-field appearance="outline">
    <mat-select (selectionChange)="onSubCategoryChange($event)" placeholder="{{ translationData.lblSelectSubCategory || 'Select Sub-Category' }}">
    <mat-option *ngFor="let rer of subCategoryList" [value]="rer.id">
        {{ rer.name }}
    </mat-option>
    </mat-select>
</mat-form-field>
  </div>
  <div fxLayout="column" fxLayoutGap="1px" fxLayoutAlign="end">
    <button mat-button  [matMenuTriggerFor]="menu"><mat-icon>file_upload</mat-icon>Export<mat-icon>more_vert</mat-icon></button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="exportGeofenceAsExcelFile()">Excel</button>
    </mat-menu>
  </div>
  <div class="areaWidth" fxLayout="column" fxLayoutGap="3px" fxLayoutAlign="end">
    <button mat-flat-button color="warn">
      <mat-icon>deleteicon</mat-icon> Delete
    </button>
  </div>
</div>
<div *ngIf='geoInitData.length == 0'>No Record Found</div>
<div *ngIf='geoInitData.length > 0'>
  <mat-table matTableExporter [dataSource]="geofencedataSource" [hiddenColumns]=[0,4] class="table-items" matSort>
    <ng-container matColumnDef="All">
      <mat-header-cell *matHeaderCellDef>
        <mat-checkbox (change)='$event ? masterToggleForGeo() : null'
          [checked]='selectedgeofences.hasValue() && isAllSelectedForGeo()'
          [indeterminate]='selectedgeofences.hasValue() && !isAllSelectedForGeo()'
          [aria-label]='checkboxLabelForGeo()'>
        </mat-checkbox>
        <span style="margin: 5px 0px 0px 5px;">All</span>
      </mat-header-cell>
      <mat-cell *matCellDef="let row">
        <span *ngIf="row.newTag" class='newTagIcon marginLeft-24'></span>
        <span *ngIf="row.newTag" class='newTxtCss'>{{ translationData.lblNew || 'New' }}</span>
        <span [ngClass]="{ 'marginLeft-14': row.newTag }"></span>
        <mat-checkbox (click)='$event.stopPropagation()' (change)='$event ? selectedgeofences.toggle(row) : null'
          [checked]='selectedgeofences.isSelected(row)' [aria-label]='checkboxLabelForGeo(row)'>
        </mat-checkbox>
      </mat-cell>
    </ng-container>
    <ng-container matColumnDef="geofenceName">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Name</mat-header-cell>
      <mat-cell *matCellDef="let row">{{ row.geofenceName }}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="categoryName">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Category</mat-header-cell>
      <mat-cell *matCellDef="let row">{{ row.categoryName }}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="subCategoryName">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Sub-Category</mat-header-cell>
      <mat-cell *matCellDef="let row">{{ row.subCategoryName }}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="Actions">
      <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
      <mat-cell *matCellDef="let row">
        <button class='actionBtn' mat-flat-button matTooltip='View'>
          <mat-icon>visibility</mat-icon>
        </button>
        <button *ngIf="!adminAccessType.adminReadOnlyAccess" class='actionBtn' mat-flat-button matTooltip="Edit">
          <mat-icon>create</mat-icon>
        </button>
        <button *ngIf="adminAccessType.adminFullAccess" class='actionBtn' mat-flat-button (click)="deleteGeofence(row)" matTooltip="Delete">
          <mat-icon class="deleteIcon">delete_outline</mat-icon>
        </button>
      </mat-cell>
    </ng-container>
    <mat-header-row *matHeaderRowDef="displayedColumnsGeo"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumnsGeo;">
    </mat-row>
  </mat-table>
  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" (page)="pageSizeUpdated($event)"></mat-paginator>
</div>
<app-spinner *ngIf="showLoadingIndicator"></app-spinner>
</mat-card>
</div>
<app-create-edit-view-poi *ngIf= "createEditViewPoiFlag" (backToPage)='checkCreationForPoi($event)'[translationData]='translationData' [actionType]='actionType' [selectedElementData]='selectedElementData' ></app-create-edit-view-poi>
<app-create-edit-view-geofence *ngIf="createEditViewGeofenceFlag" [translationData]='translationData' [actionType]='actionType'></app-create-edit-view-geofence>
</div>
<div class='bgtrans' *ngIf = "importPOIClicked">
  <app-common-import [importFileComponent]="'poi'" (showImportCSV)="updateImportView($event)"  [importTranslationData] = "importTranslationData" 
                      [templateTitle]="templateTitle" [templateValue] ="templateValue" [tableColumnList] = "tableColumnList" [tableColumnName]="tableColumnName"
                      [tableTitle]='tableTitle'
  ></app-common-import>
</div>