<form [formGroup]="notificationAdvancedFilterForm">
    <!-- Notification Frequency -->
    <mat-card class='mat-elevation-z'>
      <mat-expansion-panel class="full-width" fxLayoutGap="10px" [expanded]="true">
        <mat-expansion-panel-header class="full-width">
          <mat-panel-title>
              <span style='font: 500 16px/32px Roboto, "Helvetica Neue", sans-serif;'>{{
                translationData.lblFrequency || 'Frequency' }}<span class='mandatoryColor'>*</span></span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <div fxLayout="row" fxLayoutAlign="space-between" class="full-width filter-direction margin-bottom-sm" fxLayoutGap="10px">
            <div class="areaWidth full-width" fxLayout="column" fxLayoutAlign="left">
                <div *ngIf="actionType != 'view'" class="margin-bottom-sm">
                    <mat-radio-group [disabled]="alert_type_selected === 'D' || alert_type_selected === 'U' || alert_type_selected === 'G'" formControlName="notificationFrequency">
                        <mat-radio-button style='margin-right: 20px;' value="O">
                            {{ translationData.lblOnce || 'Once' }}
                        </mat-radio-button>
                        <mat-radio-button style='margin-right: 20px;' value="T">
                            {{ translationData.lblEachTime || 'Each Time' }}
                        </mat-radio-button>
                        <mat-radio-button style='margin-right: 20px;' value="E">
                            {{ translationData.lblEachNumberOfOccurences || 'Each Number of Occurences' }}
                        </mat-radio-button>
                    </mat-radio-group>
                </div>
                <div *ngIf="actionType == 'view'">
                  Frequency : <span style='font-weight: 500!important;'>{{ this.selectedRowData.notifications[0].frequencyType == 'O' ? (translationData.lblOnce || 'Once') : (this.selectedRowData.notifications[0].frequencyType == 'T' ? (translationData.lblEachTime || 'Each Time') : (translationData.lblEachNumberOfOccurences || 'Each Number of Occurences')) }}</span>
                </div>
                <!-- <p *ngIf="alert_category_selected != 'R' && actionType != 'view'" style="color: darkgray;">Choose appropriate frequency for this alert</p> -->
            </div>
          </div>
      </mat-expansion-panel>
    </mat-card>

    <!-- Notification validity -->
    <mat-card class='mat-elevation-z'>
        <mat-expansion-panel class="full-width" fxLayoutGap="10px" [expanded]="true">
          <mat-expansion-panel-header class="full-width">
            <mat-panel-title>
                <span style='font: 500 16px/32px Roboto, "Helvetica Neue", sans-serif;'>{{
                  translationData.lblValidity || 'Validity' }}<span class='mandatoryColor'>*</span></span>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div fxLayout="row" fxLayoutAlign="space-between" class="full-width filter-direction margin-bottom-sm" fxLayoutGap="10px">
              <div class="areaWidth full-width" fxLayout="column" fxLayoutAlign="left">
                  <div *ngIf="actionType != 'view'" class="margin-bottom-sm">
                      <mat-radio-group formControlName="validityAlwaysCustom">
                          <mat-radio-button style='margin-right: 20px;' value="A">
                              {{ translationData.lblAlways || 'Always' }}
                          </mat-radio-button>
                          <mat-radio-button style='margin-right: 20px;' value="C">
                              {{ translationData.lblCustom || 'Custom' }}
                          </mat-radio-button>
                      </mat-radio-group>
                  </div>
                  <div *ngIf="actionType == 'view'">
                    Validity Type : <span style='font-weight: 500!important;'>{{ this.selectedRowData.notifications[0].validityType == 'A' ? (translationData.lblAlways || 'Always') :  (translationData.lblCustom || 'Custom') }}</span>
                  </div>
                  <p *ngIf="actionType != 'view'" style="color: darkgray;">Define a time range when the alert will be active. This can be 'Always' or a 'Custom' time range.</p>
              </div>
            </div>

            <!-- <div fxLayout="row" fxLayoutAlign="space-between" class="full-width filter-direction margin-bottom-sm" fxLayoutGap="10px"> -->
                <div *ngIf="actionType != 'view'" fxLayout="column" fxLayoutAlign="left" fxLayoutAlign="space-between">
                    <mat-label style="font-size: 17px; font-weight: bold;" class="margin-bottom-sm">{{ translationData.lblSelectPeriod || 'Select Period' }}
                    </mat-label>
                    <mat-label class="margin-bottom-sm">{{ translationData.lblSelectoneorseveraldays || 'Select one or several days' }} <span
                        class='mandatoryColor'>*</span>
                      <mat-label style="color: darkgray;">{{ translationData.lblMax04customperiodperday || '(Max 04 custom period per
                        day)'}}</mat-label>
                        <mat-label style="color: red;" *ngIf="weekDaySelected == false">{{ translationData.lblPleaseSelectAtLeastOneDay || 'Please select at least one day'}}</mat-label>
                    </mat-label>
                    <!-- calendar -->
                    <div formArrayName="FormArrayItems">
                      <div *ngFor="let item of weekDays().controls; let periodIndex = index">
                        <div [formGroupName]="periodIndex">
                          <mat-card class='mat-elevation-z' style="border: 1px solid #000; margin-bottom: 15px;">
                            <div fxLayout="row" class="full-width margin-bottom-sm">
                              <div class="areaWidth min-width-10-per" style='margin-right: 20px;' fxLayout="column" fxLayoutAlign="left">
                                <mat-checkbox [disabled]="notificationAdvancedFilterForm.controls.validityAlwaysCustom.value == 'A'" [checked]="notificationAdvancedFilterForm.controls.validityAlwaysCustom.value == 'A'" (change)="onChangeDaySelection($event, periodIndex)" formControlName="daySelection">
                                  {{ days[periodIndex] }}
                                </mat-checkbox>
                              </div>
                              <div class="areaWidth min-width-10-per" fxLayout="column" fxLayoutAlign="left">
                                  <mat-radio-group [disabled]="item['controls']['daySelection'].value != true" formControlName="fulldayCustom">
                                    <mat-radio-button style='margin-right: 20px;' value="A">
                                        {{ translationData.lblFullDay || 'Full Day' }}
                                    </mat-radio-button>
                                    <mat-radio-button style='margin-right: 20px;' value="C">
                                        {{ translationData.lblCustomPeriod || 'Custom Period' }}
                                    </mat-radio-button>
                                  </mat-radio-group>
                              </div> 
                            </div>
                            <div  fxLayout="row" class="full-width margin-bottom-sm" *ngIf="item['controls']['fulldayCustom'].value ==  'C'">
                              <div fxLayout="column" class="full-width"  fxLayoutAlign="left">
                                <div  fxLayout="row" formArrayName="FormArrayCustomItems" class="margin-bottom-sm">
                                <!-- <div formArrayName="FormArrayCustomItems">
                                 <div *ngFor="let customItem of customPeriods(periodIndex).controls; let customIndex = index">
                                  <div [formGroupName]="customIndex"> -->
                                    <div *ngFor="let customItem of customPeriods(periodIndex).controls; let customIndex = index" style="background: #dedddd;border-radius: 7px;margin-right: 5px;"  class="areaWidth min-width-25-per" fxLayout="column" fxLayoutAlign="left">
                                      <div [formGroupName]="customIndex"  fxLayout="row" class="full-width margin-bottom-sm"  fxLayoutGap="5px">
                                        <div class="max-width-42-per" fxLayout="column">
                                          <mat-label style="margin-left: 5px;">{{ translationData.lblFrom || 'From' }}</mat-label>
                                          <mat-form-field style="margin-left: 5px;" appearance="outline" class="full-width">
                                              <input type="time" matInput formControlName="fromTime" >
                                          </mat-form-field>
                                        </div>
                                        <div class="max-width-42-per" fxLayout="column">
                                          <mat-label style="margin-left: 5px;">{{ translationData.lblTo || 'To' }}</mat-label>
                                          <mat-form-field style="margin-left: 5px;" appearance="outline" class="full-width">
                                              <input type="time" matInput formControlName="toTime" >
                                          </mat-form-field>
                                        </div>
                                        <div class="max-width-5-per" fxLayout="column">
                                          <!-- <button class='actionBtn' mat-flat-button (click)="onDeleteCustomPeriod(periodIndex, customIndex)" matTooltip="{{ translationData.lblDelete || 'Delete' }}"> -->
                                            <mat-icon class="deleteIcon" (click)="onDeleteCustomPeriod(periodIndex, customIndex)" matTooltip="{{ translationData.lblDelete || 'Delete' }}">delete_outline</mat-icon>
                                          <!-- </button> -->
                                        </div>
                
                                      </div>
                                    </div>
                                  <!-- </div>
                                 </div>
                                </div>  -->
                              </div>
                              <div fxLayout="row">
                                <div  fxLayout="column"  fxLayoutAlign="left" fxLayoutGap="10px">
                                    <button mat-raised-button color="primary" (click)='addCustomPeriod(periodIndex, [], true)'>
                                      {{ translationData.lblAdd || 'Add' }}</button>
                                  </div>
                              </div>

                              </div>   
                              <!-- <div  fxLayout="column" class="max-width-3-per"  fxLayoutAlign="left" fxLayoutGap="10px">
                                <button mat-raised-button color="primary" (click)='addCustomPeriod(periodIndex, [], true)'>
                                  {{ translationData.lblAdd || 'Add' }}</button>
                              </div> -->
                            </div>
                          </mat-card>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div *ngIf="actionType == 'view' && timings.length > 0">
                    <div fxLayout="row" fxLayoutAlign="space-between" class="full-width filter-direction margin-bottom-sm"
                      fxLayoutGap="10px">
                      <mat-label style="font-size: 17px; font-weight: bold;">{{ translationData.lblSelectedDays || 'Selected Days'}}
                      </mat-label>
                    </div>
                  
                    <div *ngFor="let days of timings">
                      <div fxLayout="row" class="areaWidth filter-direction margin-bottom-sm" fxLayoutGap="10px">
                        <mat-label>Day:<span style='font-weight: 500!important;'>{{days.day}}</span></mat-label>
                        <mat-label>Period Type:
                          <span style='font-weight: 500!important;' *ngIf="days.Type == 'C'">Custom Period</span>
                          <span style='font-weight: 500!important;' *ngIf="days.Type == 'A'">Full Day</span>
                        </mat-label>
                      </div>
                  
                      <div *ngIf="days.Type == 'C'" fxLayout="row" class="full-width filter-direction margin-bottom-sm" fxLayoutGap="5px">
                        <div *ngFor="let item of days.data" class="areaWidth min-width-20-per " fxLayout="column" fxLayoutAlign="left">
                          <div class="areaWidth min-width-30-per" fxLayout="row" fxLayoutAlign="left">
                  
                            <div class="areaWidth half-width" fxLayout="column" fxLayoutAlign="left">
                              <mat-label>{{ translationData.lblFrom || 'From' }}</mat-label>
                              <span style='font-weight: 500!important;'>{{ item.startDate }}</span>
                            </div>
                            <div class="areaWidth half-width" fxLayout="column" fxLayoutAlign="left">
                              <mat-label>{{ translationData.lblFrom || 'To' }}</mat-label>
                              <span style='font-weight: 500!important;'>{{ item.endDate }}</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div style='padding: 10px; position: relative;'>
                        <mat-divider></mat-divider>
                      </div>
                    </div>
                  
                  </div>
                  

                <!-- </div> -->
            </mat-expansion-panel>
      </mat-card>
</form>