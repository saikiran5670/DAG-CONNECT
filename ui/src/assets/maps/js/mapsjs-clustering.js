
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.30.8/HERE_NOTICE
 */

 H.util.eval("ig.prototype.Sc=ca(1,function(a,b){this.a.Sc(a,Dc(b)?b:this.c)});mg.prototype.Sc=ca(0,function(a,b){var c=0,d;if(!a(this)&&b--)for(;3>=c;c++)(d=this[c])&&d.Sc(a,b)});function St(a,b,c){this.f=this.c=c;this.zi=[];this.a=0;this.O=eg(a,b,!0)}t(\"H.clustering.grid.Cluster\",St);St.prototype.Ie=function(a){this.b||(this.b=$f(a));this.a+=a.wt||1;this.zi.push(a)};St.prototype.Ba=function(){return this.b};St.prototype.getPosition=St.prototype.Ba;St.prototype.Cc=function(){return this.a};St.prototype.getWeight=St.prototype.Cc;St.prototype.Dd=ef;St.prototype.isCluster=St.prototype.Dd;St.prototype.yc=function(){return this.c};St.prototype.getMinZoom=St.prototype.yc;\nSt.prototype.eg=function(){return this.f};St.prototype.getMaxZoom=St.prototype.eg;St.prototype.G=function(){return this.O};St.prototype.getBoundingBox=St.prototype.G;St.prototype.th=function(a){this.Ue(a)};St.prototype.forEachEntry=St.prototype.th;St.prototype.Ue=function(a){var b=this;if(!Da(a))throw new D(this.Ue,0,a);this.zi.forEach(function(c){a(new Tt(c,b.c+1))})};St.prototype.forEachDataPoint=St.prototype.Ue;function Ut(a){od.call(this);this.a=[];var b;a?Xa(b={},Vt,a):b=Vt;this.g=b;od.call(this)}u(Ut,od);var Wt={clusters:[],noisePoints:[]},Vt={projection:fj,min:0,max:22,eps:32,minWeight:2};n=Ut.prototype;n.Mc=function(a){this.a=a;this.b=!0};n.Ib=function(a){this.a.push(a);this.b=!0};n.Jf=function(a){this.a=this.a.concat(a);this.b=!0};n.qf=function(a){this.a=this.a.filter(function(b){return b!==a});this.b=!0};n.s=function(){Ut.l.s.call(this);this.a=null};n.vl=id;function Tt(a,b){this.a=a;this.b=b}t(\"H.clustering.grid.NoisePoint\",Tt);Tt.prototype.Ba=function(){return $f(this.a)};Tt.prototype.getPosition=Tt.prototype.Ba;Tt.prototype.Cc=function(){return this.a.wt};Tt.prototype.getWeight=Tt.prototype.Cc;Tt.prototype.Dd=ff;Tt.prototype.isCluster=Tt.prototype.Dd;Tt.prototype.yc=function(){return this.b};Tt.prototype.getMinZoom=Tt.prototype.yc;Tt.prototype.getData=function(){return this.a.data};Tt.prototype.getData=Tt.prototype.getData;function Xt(a){Ut.call(this,a)}u(Xt,Ut);\nXt.prototype.$i=function(a){var b=this.g,c=b.min,d=b.max,e=[],f=[],g;if(this.b){for(g=this.a;c<=d;c++){for(var h,k=void 0,l,m,p,q,r,v,w,z=c,J=g,G=e,U=f,X=b.eps,xa=b.projection,ia=b.minWeight,hc=J.length,wb=Math.pow(2,z+8),nd=[];w=J[--hc];)if(!w.ij){m=xa.ad(w).scale(wb).floor();v=wb;r=m.x;q=m.y;for(l=nd.length;l--;)h=nd[l],p=h.Ba(),h.hj||(h.hj=xa.ad(p).scale(wb).floor()),p=h.hj,p=p.$a(m),p<v&&(v=p,k=h);k&&k.G().sd(w)||(k=new St(xa.xg({x:(r-X)/wb,y:(q-X)/wb}),xa.xg({x:(r+X)/wb,y:(q+X)/wb}),z),nd.push(k));\nk.Ie(w);k=null}for(hc=nd.length;hc--;)if(h=nd[hc],l=h.Cc(),l<ia)for(h=h.zi,l=h.length;w=h[--l];)U.push(new Tt(w,z)),w.ij=!0;else G.push(h)}c=0;for(d=g.length;c<d;c++)delete g[c].ij;this.b=!1;a({clusters:e,noisePoints:f})}};function Yt(a){this.a=a;a=document.createElement(\"canvas\");var b=a.getContext(\"2d\"),c=this.a,d=14*c;a.width=d;a.height=d;b.scale(c,c);b.beginPath();b.strokeStyle=\"#FFFFFF\";b.fillStyle=\"#1080DD\";b.arc(7,7,6,0,2*Math.PI,!1);b.fill();b.lineWidth=1;b.stroke();this.f=new Rj(a,{size:{w:14,h:14},anchor:{x:7,y:7}});this.b={};this.c={}}t(\"H.clustering.theme.Circular\",Yt);\nfunction Zt(a,b,c){var d,e=document.createElement(\"canvas\"),f=e.getContext(\"2d\");var g=a.a;var h=b*g;e.width=h;e.height=h;f.scale(g,g);g=b+\":\"+c;(d=a.b[g])?f.putImageData(d,0,0):(b/=2,f.beginPath(),f.strokeStyle=\"rgba(\"+c+\",0.2)\",f.fillStyle=\"rgba(\"+c+\",1)\",f.arc(b,b,b/5*3,0,2*Math.PI,!1),f.fill(),f.lineWidth=b/5*4,f.stroke(),a.b[g]=f.getImageData(0,0,h,h));return e}\nYt.prototype.Km=function(a){var b=a.Cc();var c=this.c[b];if(!c){if(10>b){c=Zt(this,28,\"118,209,0\");var d={x:11,y:18}}else 25>b?(c=Zt(this,38,\"255,105,0\"),d={x:13,y:23}):50>b?(c=Zt(this,38,\"240,60,0\"),d={x:13,y:23}):100>b?(c=Zt(this,38,\"181,0,21\"),d={x:13,y:23}):1E3>b?(c=Zt(this,48,\"181,0,21\"),d={x:15,y:28}):(c=Zt(this,66,\"181,0,21\"),d={x:20,y:38});var e=c.getContext(\"2d\");e.fillStyle=\"#FFFFFF\";e.font=\"bold 11px Arial\";e.fillText(b,d.x,d.y);d=c.width/this.a;c=new Rj(c,{size:{w:d,h:d},anchor:{x:d/2,\ny:d/2}});this.c[b]=c}b=new Gn(a.Ba(),{icon:c,min:a.yc(),max:a.eg()});b.setData(a);return b};Yt.prototype.getClusterPresentation=Yt.prototype.Km;Yt.prototype.tn=function(a){var b=new Gn(a.Ba(),{icon:this.f,min:a.yc()});b.setData(a);return b};Yt.prototype.getNoisePresentation=Yt.prototype.tn;function $t(a){Ut.call(this,a);a=this.g;if(a.projection!==fj)throw new D($t,0,\"Other projection than mercator not supported yet\");this.m=a.projection;this.f=a.eps;this.A=a.minWeight;this.o=new gj(this.m);(new Nf).a(\"cluster\",\"H.clustering.dynamicgrid.worker\");this.i=A(this.i,this);this.j=A(this.j,this)}u($t,Ut);$t.prototype.vl=function(a,b){this.W=a;this.u=zd(b)};\n$t.prototype.$i=function(a,b){var c=this.c;var d=this.W,e=this.u||0;var f=!c||!(c.zoom===e&&c.b.oa(d));if(d&&(this.b||f)){c&&3>c.re&&c.cancel();this.b=!1;c=this.f;if(c>=128*Ed(2,e))var g=au;else{f=this.o;f.Ra(e);var h=f.mb(d.Rb());g=f.mb(d.Nb());h.y-=c;g.y+=c;h=f.lf(h);var k=f.lf(g);g=new K(h.lat,h.lng,k.lat,k.lng);c=f.Ta(c,0).lng+180;g=g.Gc(h.lat,h.lng-c,k.lat,h.lng).Gc(h.lat,k.lng,k.lat,k.lng+c)}c=g;h=this.a;g=[];for(f=h.length;f--;)c.sd(h[f])&&g.push(h[f]);0<g.length?(this.c=new bu(d,e,g,this.f,\nthis.A,this.m!==fj,a,b),this.c.then(this.i,this.j)):a(Wt)}};$t.prototype.i=function(a){Ca(a)||(a=new x.Uint32Array(a));this.c.g(cu(this,a))};$t.prototype.j=function(a){Ac(a)&&this.c.c(a)};var au=new K(90,-180,-90,180);\nfunction cu(a,b){for(var c=0,d=b[c++],e=Array(d),f=0,g=[],h=b.length,k=a.c.a,l=a.c.zoom;d--;)e[f++]=new Tt(k[b[c++]],l);for(;c<h;){d=b[c++];f=k[b[c]];var m=a.o;var p=a.f;m.Ra(a.c.zoom);var q=m.mb(f);f=m.Ta(q.x-p,q.y-p);m=m.Ta(q.x+p,q.y+p);f=new K(f.lat,f.lng,m.lat,m.lng);for(f=new St(f.Rb(),f.Nb(),l);d--;)f.Ie(k[b[c++]]);g.push(f)}return{clusters:g,noisePoints:e}}$t.prototype.s=function(){$t.l.s.call(this)};\nfunction bu(a,b,c,d,e,f,g,h){this.b=a;this.zoom=b;this.a=c;this.g=g;this.c=h;a=c.length;g=3*a;h=new (x.Float64Array||Array)(g);for(var k;a--;)k=c[a],h[--g]=k.lat,h[--g]=k.lng,h[--g]=k.wt;fe.call(this,\"cluster\",{message:[h,d,e,b,f]},void 0)}u(bu,Qf);function du(a,b,c){this.c=a;this.a=b;this.f=c}t(\"H.clustering.fastgrid.NoisePoint\",du);du.prototype.Ba=function(){this.b||(this.b=this.c.Ta(this.a[1],this.a[0],1));return this.b};du.prototype.getPosition=du.prototype.Ba;du.prototype.Cc=function(){return this.a.a};du.prototype.getWeight=du.prototype.Cc;du.prototype.Dd=ff;du.prototype.isCluster=du.prototype.Dd;du.prototype.yc=function(){return this.f-this.c.c};du.prototype.getMinZoom=du.prototype.yc;du.prototype.getData=function(){return this.a.data};\ndu.prototype.getData=du.prototype.getData;function eu(a,b,c,d){this.c=a;this.a=b;this.j=c;this.o=d;this.g=Ja(this.g,this);this.f=Ja(this.f,this)}t(\"H.clustering.fastgrid.Cluster\",eu);eu.prototype.Ba=function(){this.b||(this.b=this.c.Ta(this.a.Le,this.a.Me,this.a.Kb));return this.b};eu.prototype.getPosition=eu.prototype.Ba;eu.prototype.Cc=function(){return this.a.Kb};eu.prototype.getWeight=eu.prototype.Cc;eu.prototype.Dd=ef;eu.prototype.isCluster=eu.prototype.Dd;eu.prototype.yc=function(){return this.j?this.j-this.c.c:-1/0};\neu.prototype.getMinZoom=eu.prototype.yc;eu.prototype.eg=function(){return this.o-this.c.c};eu.prototype.getMaxZoom=eu.prototype.eg;eu.prototype.G=function(){this.O||(this.O=eg(this.c.Ta(this.a.a,this.a.f,1),this.c.Ta(this.a.b,this.a.c,1),!0));return this.O};eu.prototype.getBoundingBox=eu.prototype.G;eu.prototype.th=function(a){this.i=a;this.a.Sc(this.g,Ud)};eu.prototype.forEachEntry=eu.prototype.th;\neu.prototype.g=function(a,b){var c=!1,d,e;a.Kb>=this.c.m&&a!==this.a&&a.Kb!==this.a.Kb&&(this.i(new eu(this.c,a,0,b)),c=!0);if(!c&&(d=a.entries))for(a=d.length,e=0;e<a;e++)this.i(new du(this.c,d[e],b));return c};eu.prototype.Ue=function(a){this.m=a;this.a.Sc(this.f,Ud)};eu.prototype.forEachDataPoint=eu.prototype.Ue;eu.prototype.f=function(a,b){var c;if(a=a.entries){var d=a.length;for(c=0;c<d;c++)this.m(new du(this.c,a[c],b))}return!1};function fu(a,b,c,d,e,f){this.g=b;a&&(this.parent=a,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9]));this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}n=fu.prototype;n.qe=0;function gu(a,b){return a[b]||(++a.qe,a[b]=new fu(a,b))}n.removeChild=function(a){var b=a.g;this[b]===a&&(delete this[b],delete a.parent,--this.qe)};n.Sc=function(a,b){for(var c=0,d=this;d=d.parent;)++c;hu(this,a,b,c)};\nfunction hu(a,b,c,d){var e,f;if(!b(a,d)&&c--)for(++d,e=0;4>e;e++)(f=a[e])&&hu(f,b,c,d)}n.Le=0;n.Me=0;n.Kb=0;function iu(a){this.b=a||10;this.a=null;ju(this)}function ju(a){a.head=a.a=new fu(null,NaN,0,0,4294967296,4294967296)}function ku(a,b){var c,d;for(c=0;4>c;c++)if(d=b[c])ku(a,d),delete b[c];delete b.parent;delete b.entries}function lu(a,b){var c=a.head,d;if(b){var e=b;if(e!==c)for(c=e;e=e.parent;)if(e.entries||1<e.qe)c=e}else for(;!c.entries&&2>(d=c.qe);)if(d)c=e;else break;a.head=c}\niu.prototype.Dc=function(a,b,c,d){var e=this.a;if(!(a>=e[7]&&b>=e[4]&&a<=e[5]&&b<=e[6]))throw Error(\"Coordinates out of bounds\");return mu(this,this.a,a,b,c,this.b,d)};\nfunction mu(a,b,c,d,e,f,g){var h=b.entries;if(f)if(b.qe)h=mu(a,gu(b,c>=b[8]|(d>=b[9])<<1),c,d,e,f-1,g);else if(h){h=h[0];var k=gu(b,h[1]>=b[8]|(h[0]>=b[9])<<1);k.entries=b.entries;k.Le=b.Le;k.Me=b.Me;k.Kb=b.Kb;k.a=b.a;k.f=b.f;k.b=b.b;k.c=b.c;delete b.entries;h.node=k;lu(a,k);h=mu(a,gu(b,c>=b[8]|(d>=b[9])<<1),c,d,e,f-1,g)}else f=h=new nu(c,d,e,g),(b.entries||(b.entries=[])).push(f),lu(a,b);else h||lu(a,b),a=h=new nu(c,d,e,g),(b.entries||(b.entries=[])).push(a);b.Le+=c*e;b.Me+=d*e;b.Kb+=e;b.a===B?(b.a=\nb.b=c,b.f=b.c=d):(c<b.a?b.a=c:c>b.b&&(b.b=c),d<b.f?b.f=d:d>b.c&&(b.c=d));return h}iu.prototype.Sc=function(a,b){hu(this.a,a,b===+b?b:this.b,0)};function nu(a,b,c,d){this[0]=b;this[1]=a;this.a=c;this.data=d};function ou(a){Ut.call(this,a);a=this.g;this.j=a.projection;this.o=a.min;this.f=a.max;this.m=a.minWeight;this.c=7-yd(Cd(xd(1,a.eps))/Md);this.i=new iu(xd(this.o,this.f+this.c))}u(ou,Ut);n=ou.prototype;n.Mc=function(a){var b=0,c=a.length,d,e=new I(0,0),f=this.j,g=this.i;ou.l.Mc.call(this,a);ku(g,g.a);for(ju(g);b<c;b++)f.ad(d=a[b],e).scale(4294967296).floor(),g.Dc(e.x,e.y,d.wt,d.data);this.b=!0};n.Ib=function(a){ou.l.Ib.call(this,a);this.Mc(this.a)};\nn.Jf=function(a){for(var b=a.length,c=ou.l.Ib;b--;)c.call(this,a[b]);this.Mc(this.a)};n.qf=function(a){ou.l.qf.call(this,a);this.Mc(this.a)};n.Ta=function(a,b,c,d){return this.j.Ta(a/c/4294967296,b/c/4294967296,d)};n.$i=function(a){if(this.b){var b={clusters:[],noisePoints:[]};pu(this,this.i.a,0,this.f+this.c,-1/0,b,null);this.b=!1;a(b)}};\nfunction pu(a,b,c,d,e,f,g){var h=b.Kb,k;g&&(g.node.Kb!==h?(f.clusters.push(new eu(a,g.node,g.depth,c-1)),g=null):e++);g||(h>=a.m?(g={node:b,depth:c},e=c):qu(a,b,e+1,f));if(b.qe&&d--)for(c++,h=0;4>h;h++)if(k=b[h])pu(a,k,c,d,e,f,g),g=null;g&&f.clusters.push(new eu(a,g.node,g.depth,a.f+a.c))}function qu(a,b,c,d){b=b.entries;var e;if(b){var f=b.length;d=d.noisePoints;for(e=0;e<f;e++)d.push(new du(a,b[e],c))}else for(e=0;4>e;e++)(f=a[e])&&qu(a,f,c,d)}n.s=function(){ou.l.s.call(this);this.i=null};function ru(a,b,c,d){this.lat=a;this.lng=b;this.wt=c===+c?c:1;this.data=d}t(\"H.clustering.DataPoint\",ru);ru.prototype.Ak=NaN;ru.prototype.Ck=NaN;function su(a,b){b=b||{};var c={},d=b.min||0,e=xd(d,b.max||22);d={min:d,max:e};su.l.constructor.call(this,d);this.Fa=b.pixelRatio||Te();Xa(c,Vt,d,b.clusteringOptions||{});c.minWeight=xd(Vt.minWeight,c.minWeight);switch(c.strategy){case tu.DYNAMICGRID:if(c.projection!==fj)throw new D(su,1,\"Unsupported projection\");this.a=new $t(c);break;case tu.GRID:this.a=new Xt(c);break;default:this.a=new ou(c)}this.a.Mc(a);this.A=b.theme||new Yt(this.Fa);this.aa=A(this.aa,this);this.ma=A(this.ma,this);uu(this)}\nu(su,N);t(\"H.clustering.Provider\",su);su.prototype.s=function(){su.l.s.call(this);this.c.ra();this.a.C();this.A=this.L=this.a=null;x.clearTimeout(this.T)};var tu={FASTGRID:0,GRID:1,DYNAMICGRID:2};su.Strategy=tu;su.prototype.aa=function(){this.dispatchEvent(\"start\");this.a.$i(this.ma,id)};function uu(a,b,c){a.T&&x.clearTimeout(a.T);b&&a.a.vl(b,c);a.T=x.setTimeout(a.aa,150)}su.prototype.ma=function(a){this.dispatchEvent(\"end\");this.L=a;vu(this)};su.prototype.Mc=function(a){this.a.Mc(a);uu(this)};\nsu.prototype.setDataPoints=su.prototype.Mc;su.prototype.Ib=function(a){this.a.Ib(a);uu(this)};su.prototype.addDataPoint=su.prototype.Ib;su.prototype.Jf=function(a){this.a.Jf(a);uu(this)};su.prototype.addDataPoints=su.prototype.Jf;su.prototype.qf=function(a){this.a.qf(a);uu(this)};su.prototype.removeDataPoint=su.prototype.qf;su.prototype.On=function(){return this.A};su.prototype.getTheme=su.prototype.On;su.prototype.cp=function(a){this.A=a;this.L&&(this.c.ra(),vu(this))};su.prototype.setTheme=su.prototype.cp;\nfunction vu(a){var b=a.L.clusters,c=a.L.noisePoints,d=b.length,e=c.length,f=0<d+e;for(a.c.ra();e--;){var g=c[e];a.c.da(a.A.getNoisePresentation(g))}for(;d--;)c=b[d],a.c.da(a.A.getClusterPresentation(c));f&&a.Za()}su.prototype.Vb=function(){return!0};su.prototype.providesDomMarkers=su.prototype.Vb;su.prototype.Wb=function(){return!0};su.prototype.providesMarkers=su.prototype.Wb;su.prototype.Hc=function(){return!0};su.prototype.providesSpatials=su.prototype.Hc;\nsu.prototype.nf=function(a,b){uu(this,a,b)};su.prototype.preprocessData=su.prototype.nf;t(\"H.clustering.buildInfo\",function(){return Ff(\"H-clustering\",\"1.30.8\",\"5f44999\")});\n");